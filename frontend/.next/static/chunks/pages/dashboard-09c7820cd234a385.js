(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(5108)}])},6153:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5893),o=r(1163);function a(e){let{children:t}=e,r=(0,o.useRouter)();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("nav",{className:"bg-white shadow mb-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-3 flex justify-between items-center",children:[(0,s.jsx)("div",{className:"font-bold text-lg text-blue-700",children:"WWR Notify Me"}),(0,s.jsxs)("div",{className:"space-x-4",children:[(0,s.jsx)("a",{href:"/dashboard",className:"text-gray-700 hover:text-blue-700",children:"Dashboard"}),(0,s.jsx)("a",{href:"/preferences",className:"text-gray-700 hover:text-blue-700",children:"Preferences"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),r.replace("/login")},className:"text-gray-700 hover:text-red-600 ml-2",children:"Logout"})]})]})}),(0,s.jsx)("main",{children:t})]})}},5108:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var s=r(5893),o=r(7294),a=r(1163),n=r(7066),i=r(6153);function l(e){var t,r;let{job:o,showFeed:a}=e,n="twitter"===o.source?{name:"Twitter",url:"https://twitter.com/JobFound5",color:"text-blue-500",bgColor:"bg-blue-50",borderColor:"border-blue-200"}:{name:"We Work Remotely",url:"https://weworkremotely.com",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"};return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-50 text-green-600 mb-3",children:"RSS"}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-3 line-clamp-2 leading-tight",children:o.title}),(0,s.jsxs)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3 leading-relaxed",children:[null===(t=o.description)||void 0===t?void 0:t.substring(0,150),(null===(r=o.description)||void 0===r?void 0:r.length)>150?"...":""]}),a&&o.feedUrl&&(0,s.jsxs)("div",{className:"text-xs text-blue-700 mb-2",children:[(0,s.jsx)("span",{children:"Feed: "}),(0,s.jsx)("a",{href:o.feedUrl,target:"_blank",rel:"noopener noreferrer",className:"underline",children:o.feedUrl})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center text-xs text-gray-500",children:o.publishedDate&&new Date(o.publishedDate).toLocaleDateString()}),(0,s.jsx)("a",{href:o.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Apply"})]})]}),(0,s.jsx)("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-100",children:(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["Job posted on"," ",(0,s.jsx)("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"".concat(n.color," hover:underline font-medium"),children:n.name}),o.author&&"twitter"===o.source&&(0,s.jsxs)("span",{className:"ml-1",children:["by @",o.author]})]})})]})}let d=null,c=null;try{d=r(Object(function(){var e=Error("Cannot find module '@capacitor/local-notifications'");throw e.code="MODULE_NOT_FOUND",e}())),c=r(Object(function(){var e=Error("Cannot find module '@capacitor/push-notifications'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(e){}function u(){let e=(0,a.useRouter)(),[t,r]=(0,o.useState)([]),[u,m]=(0,o.useState)(!0),[h,x]=(0,o.useState)(""),[f,g]=(0,o.useState)(new Date().toISOString().split("T")[0]),[b,p]=(0,o.useState)(!0),[v,w]=(0,o.useState)(!1),[N,j]=(0,o.useState)(new Date().getMonth()+1),[y,S]=(0,o.useState)(new Date().getFullYear()),[k,_]=(0,o.useState)({}),[D,L]=(0,o.useState)(!1),[C,E]=(0,o.useState)([]),[I,P]=(0,o.useState)(!1),[F,M]=(0,o.useState)(null),[O,T]=(0,o.useState)(""),[A,J]=(0,o.useState)(""),[B,R]=(0,o.useState)(""),[z,U]=(0,o.useState)(null),[Z,H]=(0,o.useState)(0),[W,$]=(0,o.useState)([]),q=async()=>{var e,t,r,s;P(!0),M(null),H(0);try{let r=localStorage.getItem("token"),s=(await n.Z.get("".concat("http://192.168.43.160:4000","/api/user/rss-feeds"),{headers:{Authorization:"Bearer ".concat(r)}})).data.feeds||[];$(s);let o=[];for(let a=0;a<s.length;a++){let i=s[a];try{let e=await n.Z.get("".concat("http://192.168.43.160:4000","/api/user/rss-feeds/").concat(i._id,"/raw"),{headers:{Authorization:"Bearer ".concat(r)}});o.push(e.data)}catch(r){o.push({feed:{url:i.url,name:i.name},items:[],error:(null===(t=r.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||r.message})}H(Math.round((a+1)/s.length*100))}E(o)}catch(e){M((null===(s=e.response)||void 0===s?void 0:null===(r=s.data)||void 0===r?void 0:r.error)||e.message)}finally{P(!1),setTimeout(()=>H(0),500)}};(0,o.useEffect)(()=>{let t=localStorage.getItem("token");if(!t){e.replace("/login");return}Y(t),K(t),q()},[e,f,D]),(0,o.useEffect)(()=>{let e=setInterval(()=>{q(),X(!0),setTimeout(()=>X(!1),2e3)},3e5);return()=>clearInterval(e)},[]);let[V,X]=(0,o.useState)(!1),Y=async e=>{try{m(!0),x("");let t="".concat("http://192.168.43.160:4000","/api/jobs?");D?t+="last24h=true":t+="date=".concat(f);let s=await n.Z.get(t,{headers:{Authorization:"Bearer ".concat(e)}});r(s.data.jobs||[])}catch(e){var t,s;x((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to load jobs"),r([])}finally{m(!1)}},K=async e=>{try{let t=await n.Z.get("".concat("http://192.168.43.160:4000","/api/jobs/calendar?month=").concat(N,"&year=").concat(y,"&filterByPreferences=").concat(b),{headers:{Authorization:"Bearer ".concat(e)}});_(t.data.calendarData||[])}catch(e){console.error("Error fetching calendar data:",e)}},G=(0,o.useMemo)(()=>{let e=new Set;return C.forEach(t=>{(t.items||[]).forEach(t=>{t.categories&&Array.isArray(t.categories)&&t.categories.forEach(t=>e.add(t))})}),Array.from(e).sort()},[C]),Q=(0,o.useMemo)(()=>B?C.map(e=>({...e,items:(e.items||[]).filter(e=>e.categories&&e.categories.includes(B))})):C,[C,B]),ee=(0,o.useMemo)(()=>C.reduce((e,t)=>e+(t.items?t.items.length:0),0),[C]),[et,er]=(0,o.useState)(!1),es=(0,o.useMemo)(()=>{if(et)return Q;let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()-2,0,0,0,0);return Q.map(r=>({...r,items:(r.items||[]).filter(r=>{if(!r.pubDate)return!1;let s=new Date(r.pubDate);return s>=t&&s<=e})}))},[Q,et]),eo=(0,o.useMemo)(()=>{if(!O.trim())return es;let e=O.trim().toLowerCase().split(/\s+/).filter(Boolean);return es.map(t=>({...t,items:(t.items||[]).filter(t=>{let r=[t.title,t.description,t.content,t.contentSnippet];return e.every(e=>r.some(t=>t&&t.toLowerCase().includes(e)))})}))},[es,O]);function ea(e){if(!O.trim()||!e)return e;let t=O.trim().split(/\s+/).filter(Boolean),r=e;return t.forEach(e=>{if(!e)return;let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=RegExp("(".concat(t,")"),"gi");r=r.replace(s,"<mark>$1</mark>")}),r}async function en(e,t){let r="New job: ".concat(e.title),s="From: ".concat(t),o=e.link||e.guid||"";d&&d.LocalNotifications?await d.LocalNotifications.schedule({notifications:[{title:r,body:s,id:Date.now(),smallIcon:"ic_launcher",actionTypeId:"",extra:{url:o}}]}):"Notification"in window&&("granted"===Notification.permission?new Notification(r,{body:s,data:{url:o}}).onclick=()=>{o&&window.open(o,"_blank")}:"denied"!==Notification.permission&&Notification.requestPermission())}return(0,o.useEffect)(()=>{if(!C||!C.length)return;let e=(localStorage.getItem("alertKeywords")||"").split(/,|\n/).map(e=>e.trim().toLowerCase()).filter(Boolean);if(!e.length)return;let t=new Set(JSON.parse(localStorage.getItem("notifiedJobIds")||"[]")),r=Array.from(t);C.forEach(s=>{var o,a;let n=(null===(o=s.feed)||void 0===o?void 0:o.name)||(null===(a=s.feed)||void 0===a?void 0:a.url)||"Unknown Feed";(s.items||[]).forEach(s=>{let o=s.guid||s.link||s.title;if(!o||t.has(o))return;let a=(s.title||"").toLowerCase();e.some(e=>a.includes(e))&&(en(s,n),r.push(o))})}),r.length>t.size&&localStorage.setItem("notifiedJobIds",JSON.stringify(r))},[C]),(0,o.useEffect)(()=>{d&&d.LocalNotifications&&d.LocalNotifications.addListener("localNotificationActionPerformed",e=>{var t,r;let s=null==e?void 0:null===(r=e.notification)||void 0===r?void 0:null===(t=r.extra)||void 0===t?void 0:t.url;s&&window.open(s,"_blank")})},[]),(0,o.useEffect)(()=>{c&&c.PushNotifications&&(c.PushNotifications.requestPermissions().then(e=>{"granted"===e.receive&&c.PushNotifications.register()}),c.PushNotifications.addListener("registration",e=>{console.log("Push registration token:",e.value)}),c.PushNotifications.addListener("registrationError",e=>{console.error("Push registration error:",e)}),c.PushNotifications.addListener("pushNotificationReceived",e=>{console.log("Push notification received:",e)}),c.PushNotifications.addListener("pushNotificationActionPerformed",e=>{var t,r;let s=null==e?void 0:null===(r=e.notification)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.url;s&&window.open(s,"_blank")}))},[]),(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto py-8 px-4",children:[(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6 mb-8 flex flex-col md:flex-row md:items-center md:justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:"Remote Jobs Dashboard"}),(0,s.jsxs)("div",{className:"text-gray-600 text-lg",children:[ee," job",1===ee?"":"s"," fetched across all feeds"]})]})}),h&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-red-600",children:h})}),I&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 animate-pulse",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:"Fetching the freshest remote jobs for you..."}),(0,s.jsx)("div",{className:"text-lg text-blue-400 italic mb-4",children:"Hang tight, your dream job might be in this batch! \uD83D\uDE80"}),(0,s.jsx)("div",{className:"w-full max-w-md h-4 bg-blue-100 rounded-full overflow-hidden shadow mb-2",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-400 to-blue-600 transition-all duration-200",style:{width:"".concat(Z,"%")}})}),(0,s.jsxs)("div",{className:"text-sm text-blue-700 font-semibold",children:[Z,"%"]})]}),V&&(0,s.jsx)("div",{className:"fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow-lg z-50 transition",children:"Jobs auto-refreshed!"}),!u&&0===t.length&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row md:items-center md:space-x-4",children:[(0,s.jsx)("label",{className:"font-semibold text-gray-700 mb-2 md:mb-0",children:"Filter by Category:"}),(0,s.jsxs)("select",{value:B,onChange:e=>R(e.target.value),className:"px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white text-gray-800",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),G.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})}),!u&&t.length>0&&(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>(0,s.jsx)(l,{job:e,showFeed:!0},e.wwrJobId||e._id))}),(0,s.jsxs)("div",{className:"mb-6 flex items-center gap-4",children:[(0,s.jsx)("button",{className:"px-4 py-2 rounded-lg font-semibold shadow transition ".concat(et?"bg-gray-200 text-gray-700":"bg-blue-600 text-white hover:bg-blue-700"),onClick:()=>er(!1),children:"Recent Jobs (Last 3 Days)"}),(0,s.jsx)("button",{className:"px-4 py-2 rounded-lg font-semibold shadow transition ".concat(et?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-700"),onClick:()=>er(!0),children:"View Older Jobs"})]}),(0,s.jsxs)("div",{className:"mt-16",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Filter by keyword...",value:O,onChange:e=>{T(e.target.value),""===e.target.value&&q()},className:"border px-3 py-2 rounded-lg w-full md:w-1/3 focus:outline-none focus:ring-2 focus:ring-blue-400 transition"}),(0,s.jsx)("input",{type:"date",value:A,onChange:e=>{J(e.target.value),q()},className:"border px-3 py-2 rounded-lg w-full md:w-1/3 focus:outline-none focus:ring-2 focus:ring-blue-400 transition"}),(0,s.jsx)("button",{onClick:()=>q(),className:"bg-gradient-to-r from-blue-600 to-blue-400 text-white px-6 py-2 rounded-lg shadow hover:from-blue-700 hover:to-blue-500 transition font-semibold",disabled:I,children:I?"Loading...":"Fetch Feeds"})]}),F&&(0,s.jsx)("div",{className:"text-red-600 mb-2 font-semibold",children:F}),(0,s.jsx)("div",{className:"space-y-8",children:eo.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg",children:[(0,s.jsxs)("button",{className:"w-full flex justify-between items-center px-6 py-4 text-left focus:outline-none focus:ring-2 focus:ring-blue-400 rounded-t-xl bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition",onClick:()=>U(z===e.feed.url?null:e.feed.url),children:[(0,s.jsxs)("span",{className:"text-xl font-semibold text-blue-700 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-blue-400"}),e.feed.name||e.feed.url]}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:[e.items.length," job",1===e.items.length?"":"s"]}),(0,s.jsx)("svg",{className:"w-5 h-5 ml-2 transform transition-transform ".concat(z===e.feed.url?"rotate-180":""),fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),z===e.feed.url&&(0,s.jsx)("div",{className:"px-6 pb-6 pt-2",children:e.error?(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4 mb-4 font-medium shadow-sm",children:e.error}):(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.items.map((e,t)=>(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-md p-5 hover:shadow-xl hover:border-blue-400 transition cursor-pointer flex flex-col justify-between min-h-[180px]",onClick:()=>window.open(e.link,"_blank"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold text-lg mb-1 text-gray-900 line-clamp-2",dangerouslySetInnerHTML:{__html:ea(e.title)}}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:e.pubDate&&new Date(e.pubDate).toLocaleString()}),e.content&&/<\/?[a-z][\s\S]*>/i.test(e.content)?(0,s.jsx)("div",{className:"text-gray-700 mb-2 line-clamp-3",dangerouslySetInnerHTML:{__html:ea(e.content)}}):e.description&&/<\/?[a-z][\s\S]*>/i.test(e.description)?(0,s.jsx)("div",{className:"text-gray-700 mb-2 line-clamp-3",dangerouslySetInnerHTML:{__html:ea(e.description)}}):(0,s.jsx)("div",{className:"text-gray-700 mb-2 line-clamp-3",dangerouslySetInnerHTML:{__html:ea(e.contentSnippet||e.description||"")}})]}),(0,s.jsx)("div",{className:"mt-2 text-blue-600 font-semibold text-sm underline self-end",children:"View Job"})]},e.guid||e.link||t)),0===e.items.length&&(0,s.jsx)("div",{className:"text-gray-400 italic",children:"No jobs found for this feed."})]})})]},e.feed.url))})]})]})})}}},function(e){e.O(0,[143,888,774,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);